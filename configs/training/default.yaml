# @package training
_target_: src.train.trainer.Trainer

# Training configuration
max_epochs: 100
patience: 20
min_delta: 0.001

# Optimizer
optimizer:
  _target_: torch.optim.Adam
  lr: 0.01
  weight_decay: 5e-4
  betas: [0.9, 0.999]

# Learning rate scheduler
scheduler:
  _target_: torch.optim.lr_scheduler.ReduceLROnPlateau
  mode: "min"
  factor: 0.5
  patience: 10
  min_lr: 1e-6

# Loss function
loss_function: "cross_entropy"  # cross_entropy, nll_loss

# Validation
val_check_interval: 1.0
val_check_interval_unit: "epoch"

# Checkpointing
checkpoint:
  save_top_k: 3
  monitor: "val_acc"
  mode: "max"
  save_last: true
  filename: "epoch={epoch:02d}-val_acc={val_acc:.4f}"

# Early stopping
early_stopping:
  monitor: "val_acc"
  mode: "max"
  patience: 20
  min_delta: 0.001
